This folder contains code that were used to produce the barplots showing Gene Ontology enrichment analysis results for 99 full-stack states (Additional file 2 in the paper). One state could not run sucessfully by GREAT (we tried many times). We did this analysis by running a pipeline using Snakemake. If you ever need to reproduce the results of Additional File 2, you can download the code from this folder and modify the code in Snakefile (redefining the relative paths of input and output files). 
|__Snakefile: The file that specifies the entire pipeline. The steps in the pipeline include: 
1, First, given the full-stack state annotations (file hg19_genome_100_segments.bed.gz where we provided the download link in the main readme file), we will create 100 bed files, each showing the coordinates of positions corresponding to one state.
2, Second, transfer the files from step 1 to a location such that we can easily access these files online. This step is very specific to our local computing system. Basically, we need to eventually run GREAT 100 times with 100 different bed files. You can technically upload 100 bed files on GREAT website and get 100 output files. But, we created this pipeline to avoid such repetitive manual work. 
3, Third, create a temporary file jobList that lists the necessary information to run greatBatchQuery.py (provided by the creaters of GREAT, downloaded from https://great-help.atlassian.net/wiki/spaces/GREAT/pages/655447/Programming+Interface) 100 times. 
4, Fourth, based on the data outputted from GREAT, create barplot of the top 5 GO molecular function and top 5 GO biological processes assocated with each state. This results in the pages in Additional File 2 provided in the paper. 

Our pipeline was written very specifically for our computing system. But the snakefile has been heavily commented to help you navigate the process. If you need help, please contact Ha Vu (havu73@ucla.edu).