This folder contains files that are useful for analyzing the overlap enrichment results outputted from ChromHMM OverlapEnrichment as we calculate the fold enrichment between full-stakc states and different classes of genomic annotations
|__create_overlap_enrichment.sh: bash file that will create an executable file with commands to run ChromHMM OverlapEnrichment. Terminal input:  ./create_overlap_enrichment.sh <folder where we store the output .sh file> <name of the .sh file (without .sh)> <fn of state segmentation file> <fn of the folder/file with the target enrichment annotations> <output_folder> <output_prefix: prefix of the output file name(without .txt), which will be outputted by ChromHMM OverlapEnrichment>. This file will create an .sh file, which you can then run to get the results of overlap enrichments between full-stack states and the target genome annotations. 
|__create_excel_painted_overlap_enrichment_output.py: after running the output .sh executable file of _create_overlap_enrichment.sh, run this file to create an excel with heatmap showing the enrichments of full stack states with genome annotations (like those provided in AF4 and those that are the source excel of Fig. 3A and multiple other supplementary figures in the paper). Terminal input: <raw_overlap_fn: output from ChromHMM OverlapEnrichment> <output_fn: path to the output excel file> <context_prefix: if we want all the genome annotation to have a prefix, we can input the prefix here, otherwise, just keep it as ''> <state_annot_fn: ../state_annotations.csv>
|__get_top_enriched_states_one_enrichment_file.py:  after running the output .sh executable file of _create_overlap_enrichment.sh, run this file to create an excel showing the top N most enriched states for each enrichment annotation category. Only states that are in the top N most enriched states are shown in this excel, the heatmap will highlight the top 5 states by ranking. The result excel produced source for figures 5ACEF, and some other supplementary figures. Terminal input: <raw_overlap_fn: output from ChromHMM OverlapEnrichment> <output_fn: path to the output excel file> <N: number of top N states to select for each enrichment category> <state_annot_fn: ../state_annotations.csv>
|__test_binom_overlap_excel.py: after running the output .sh executable file of _create_overlap_enrichment.sh, run this file to get the p-value of enrichments based on the binomial tests. The enrichments between states that annotations that are significant based on the Bonferroni-corrected p-value threshold with alpha of 0.05 will be highlighted in blue in the output excel. <segment_fn: the segmentation file of full-stack state annotaion> <overlap_fn: result of ChromHMM OverlapEnrichment, showing the fold enrichments of chromatin states and different genome annotation category> <output_fn: where>
|__summarize_auc_overlap_for_publication.py: After running create_roc_curve_overlap_enrichment.py, we can use this file to summarize the performance of full-stack annotations compared to other concatenated/independent annotations in terms of the AUROC of predicting locations of external genome annotations. This file is used to produce results presented in AF6: "Data of AUROC comparison between full-stack annotation and concatenated and independent annotations in predicting different genomic contexts". 